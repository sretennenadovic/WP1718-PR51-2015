<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <style>

        /**********************************************************************************************************************/
        /*Padajuci meni kopirao sam sa w3*/
        .dropbtn {
            background-color: #4CAF50;
            color: white;
            padding: 16px;
            font-size: 16px;
            border: none;
            cursor: pointer;
        }

        /* The container <div> - needed to position the dropdown content */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        /* Dropdown Content (Hidden by Default) */
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            top:55px;
        }

            /* Links inside the dropdown */
            .dropdown-content a {
                color: black;
                padding: 12px 16px;
                text-decoration: none;
                display: block;
            }

                /* Change color of dropdown links on hover */
                .dropdown-content a:hover {
                    background-color: cornflowerblue;
                }

        /* Show the dropdown menu on hover */
        .dropdown:hover .dropdown-content {
            display: block;
        }

        /* Change the background color of the dropdown button when the dropdown content is shown */
        .dropdown:hover .dropbtn {
            background-color: #3e8e41;
        }
        
        /*kraj padajuci meni*/
        /**********************************************************************************************************************/


        footer {
            background-color: #f2f2f2;
            padding: 25px;
        }

        /*samo klasa za nav bar visina i boja*/
        .nova {
            background-color: #ffd700;
            height:55px;
        }

        /*za sliku (logo) taksija*/
        img {
            transform: rotate(-20deg);
            height: 500px;
            width: auto;
        }

        /*div*/
        #wrapper {
            overflow: auto;
        }

        /*div takodje za naslov koji pise u nav baru*/
        #d1 {
            position: absolute;
            right: 45%;
            top: 6px;
            font-size: 30px;
            font-weight: bold;
        }

        /*logo na sredini sto se nalazi*/
        #soloPic,#soloPicd {
            position: absolute;
            right: 35%;
            top: 15%;
            opacity: 0.7;
        }

        /*div*/
        #zaprofil,#zaprofild{
            position:absolute;
            top:80px;
            left:80px;
        }

        /*div*/
        #zaizmenu,#zaizmenud{
            position: absolute;
            top: 80px;
            left: 80px;
        }

        /*font u bodyiu*/
        body {
            font-size: 20px;
        }

        /*font u nav tagu*/
        nav {
            font-size: 20px;
        }

    </style>
    <script src="Scripts/jquery-1.10.2.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            //pomocne promenljive
            let korisnik;
            let korisnickoIme = localStorage.getItem("Ulogovan");
            if (korisnickoIme == "null") {
                $(location).attr('href', 'index.html');
            }
            let korisnickiId;


            //pomocu korisnickog imena yahtevam preko post metode od servera da mi vrati celog korisnika (dole u ajaxu nastavak)
            let Korisnik = {
                KorisnickoIme: `${korisnickoIme}`
            };


            $.ajax({
                type: 'POST',
                url: '/api/User',
                data: JSON.stringify(Korisnik),
                contentType: 'application/json;charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    korisnik = data;
                    korisnickiId = data.Id;
                    //prikaz odredjenog diva za odredjenu ulogu korisnika
                    if (korisnik.Uloga == 0) {
                        $('#vozac').hide();
                        $('#dispecer').hide();
                        $('#korisnik').show();
                        $('#zaprofil').hide();
                        $('#zaizmenu').hide();
                    } else if (korisnik.Uloga == 1) {
                        $('#vozac').hide();
                        $('#korisnik').hide();
                        $('#dispecer').show();
                        $('#zaprofild').hide();
                        $('#zaizmenud').hide();
                    } else {
                        $('#korisnik').hide();
                        $('#dispecer').hide();
                        $('#vozac').show();
                    }
                }
            })



            /*pri kliku na link profil*/
            $('#profil').click(function () {
                $.ajax({
                    type: 'POST',
                    url: '/api/User',
                    data: JSON.stringify(Korisnik),
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        korisnik = data;
                        korisnickiId = data.Id;
                        //prikaz odredjenog diva za odredjenu ulogu korisnika
                        if (korisnik.Uloga == 0) {
                            $('#vozac').hide();
                            $('#dispecer').hide();
                            $('#korisnik').show();
                            $('#zaprofil').hide();
                            $('#zaizmenu').hide();
                        } else if (korisnik.Uloga == 1) {
                            $('#vozac').hide();
                            $('#korisnik').hide();
                            $('#dispecer').show();
                            $('#zaprofild').hide();
                            $('#zaizmenud').hide();
                        } else {
                            $('#korisnik').hide();
                            $('#dispecer').hide();
                            $('#vozac').show();
                        }
                        $('#zaizmenu').hide();
                        $('#1').text(korisnik.KorisnickoIme);
                        $('#2').text(korisnik.Lozinka);
                        $('#3').text(korisnik.Ime);
                        $('#4').text(korisnik.Prezime);
                        $('#5').text(korisnik.JMBG);
                        if (korisnik.Pol == 0) {
                            $('#6').text("Muški");
                        } else {
                            $('#6').text("Ženski");
                        }
                        $('#7').text(korisnik.KontaktTelefon);
                        $('#8').text(korisnik.Email);
                        $('#zaprofil').fadeIn(500);
                    }
                })
            })
        
        

            $('#profild').click(function () {
                //------------------------------------------------------------------------------------------------------------
                //moram da ponavljam je r kada uradim izmenu, mora opet novo da mi povuce 
                $.ajax({
                    type: 'POST',
                    url: '/api/User',
                    data: JSON.stringify(Korisnik),
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        korisnik = data;
                        korisnickiId = data.Id;
                        //prikaz odredjenog diva za odredjenu ulogu korisnika
                        if (korisnik.Uloga == 0) {
                            $('#vozac').hide();
                            $('#dispecer').hide();
                            $('#korisnik').show();
                            $('#zaprofil').hide();
                            $('#zaizmenu').hide();
                        } else if (korisnik.Uloga == 1) {
                            $('#vozac').hide();
                            $('#korisnik').hide();
                            $('#dispecer').show();
                            $('#zaprofild').hide();
                            $('#zaizmenud').hide();
                        } else {
                            $('#korisnik').hide();
                            $('#dispecer').hide();
                            $('#vozac').show();
                        }
                        $('#zaizmenud').hide();
                        $('#1d').text(korisnik.KorisnickoIme);
                        $('#2d').text(korisnik.Lozinka);
                        $('#3d').text(korisnik.Ime);
                        $('#4d').text(korisnik.Prezime);
                        $('#5d').text(korisnik.JMBG);
                        if (korisnik.Pol == 0) {
                            $('#6d').text("Muški");
                        } else {
                            $('#6d').text("Ženski");
                        }
                        $('#7d').text(korisnik.KontaktTelefon);
                        $('#8d').text(korisnik.Email);
                        $('#zaprofild').fadeIn(500);
                    }
                })
            })

            /*pri kliku na link izmeni*/
            $('#izmenid').click(function () {
                $('#zaprofild').hide();
                $('#KorisnickoImed').val(korisnik.KorisnickoIme);
                $('#Lozinkad').val(korisnik.Lozinka);
                $('#Imed').val(korisnik.Ime);
                $('#Prezimed').val(korisnik.Prezime);
                $('#JMBGd').val(korisnik.JMBG);
                /*   if (korisnik.Pol == 0) {
                        $('#Pol').text("Muški");
                    } else {
                        $('#6').text("Ženski");
                    }*/
                $('#KontaktTelefond').val(korisnik.KontaktTelefon);
                $('#Emaild').val(korisnik.Email);
                $('#zaizmenud').fadeIn(500);
            })

            $('#izmeni').click(function () {
                $('#zaprofil').hide();
                $('#KorisnickoIme').val(korisnik.KorisnickoIme);
                $('#Lozinka').val(korisnik.Lozinka);
                $('#Ime').val(korisnik.Ime);
                $('#Prezime').val(korisnik.Prezime);
                $('#JMBG').val(korisnik.JMBG);
                if (korisnik.Pol == 0) {
                    $('#Pol1').prop('checked', true);
                    } else {
                    $('#Pol2').prop('checked', true);
                    }
                $('#KontaktTelefon').val(korisnik.KontaktTelefon);
                $('#Email').val(korisnik.Email);
                $('#zaizmenu').fadeIn(500);
                

            })
            //kraj linka izmeni

            //dugme izmeniii
            $('#izmena').click(function (data) {
                 let pol;
                 if ($('#Pol1').prop('checked')) {
                     pol = 'Muski';
                 } else if ($('#Pol2').prop('checked')){
                     pol = 'Zenski';
                 }
                let KorisnikIzmena = {
                    Id: korisnickiId,
                    KorisnickoIme: `${$('#KorisnickoIme').val()}`,
                    Lozinka: `${$('#Lozinka').val()}`,
                    Ime: `${$('#Ime').val()}`,
                    Prezime: `${$('#Prezime').val()}`,
                    Pol: pol,
                    JMBG: `${$('#JMBG').val()}`,
                    KontaktTelefon: `${$('#KontaktTelefon').val()}`,
                    Email: `${$('#Email').val()}`,
                    Uloga: 'Musterija',
                    Voznje: 'nema'
                };

                $.ajax({
                    type: 'POST',
                    url: '/api/ChangingM',
                    data: JSON.stringify(KorisnikIzmena),
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (!data) {
                            alert("korisnik nije uspesno izmenio");
                        } else {
                            alert("Uspesno ste se promenili!");
                            localStorage.setItem("Ulogovan", KorisnikIzmena.KorisnickoIme);
                            Korisnik.KorisnickoIme = KorisnikIzmena.KorisnickoIme;
                        }
                    }
                })
            })

            $('#izmenad').click(function (data) {
                let pol;
                if ($('#Pol1').prop('checked')) {
                    pol = 'Muski';
                } else if ($('#Pol2').prop('checked')) {
                    pol = 'Zenski';
                }
                let KorisnikIzmena = {
                    Id: korisnickiId,
                    KorisnickoIme: `${$('#KorisnickoImed').val()}`,
                    Lozinka: `${$('#Lozinkad').val()}`,
                    Ime: `${$('#Imed').val()}`,
                    Prezime: `${$('#Prezimed').val()}`,
                    Pol: 'Muski',
                    JMBG: `${$('#JMBGd').val()}`,
                    KontaktTelefon: `${$('#KontaktTelefond').val()}`,
                    Email: `${$('#Emaild').val()}`,
                    Uloga: 'Dispecer',
                    Voznje: 'nema'
                };

                $.ajax({
                    type: 'POST',
                    url: '/api/ChangingD',
                    data: JSON.stringify(KorisnikIzmena),
                    contentType: 'application/json;charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (!data) {
                            alert("korisnik nije uspesno izmenio");
                        } else {
                            alert("Uspesno ste se promenili!");
                            localStorage.setItem("Ulogovan", KorisnikIzmena.KorisnickoIme);
                            Korisnik.KorisnickoIme = KorisnikIzmena.KorisnickoIme;
                        }
                    }
                })
            })
             //kraj izmenii

            $('#odjavi,#odjavid').click(function () {
                localStorage.setItem("Ulogovan",null);
                $(location).attr('href', 'index.html');
            })
        })






     





    </script>
</head>
<body>
    <div id="korisnik">
        <nav class="nova">
            <div class="container-fluid">
                <div class="collapse navbar-collapse">
                    <div id="d1">
                        Gold TAXI
                    </div>
                    <div class="dropdown">
                        <ul class="nav navbar-nav navbar-right">
                            <li>
                                <button style="background-color:#ffd700;border:none;height:55px;width:auto"><i class="material-icons" style="font-size:xx-large;margin-top:8px">person</i> </button>
                            </li>
                        </ul>
                        <div class="dropdown-content">
                            <a href="#" id="profil">Profil</a>
                            <a href="#" id="izmeni">Izmeni</a>
                            <a href="#" id="odjavi">Odjavi se</a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <img src="35240528_10210948662984084_1324220601556008960_n.png" id="soloPic" />
        <div id="zaprofil">
            <h2>Korisnički profil</h2>
            <hr />
            <table>
                <tr><th>Korisničko ime:</th><td id="1"></td></tr>
                <tr><th>Lozinka:</th><td id="2"></td></tr>
                <tr><th>Ime:</th><td id="3"></td></tr>
                <tr><th>Prezime:</th><td id="4"></td></tr>
                <tr><th>JMBG:</th><td id="5"></td></tr>
                <tr><th>Pol:</th><td id="6"></td></tr>
                <tr><th>Kontakt Telefon:</th><td id="7"></td></tr>
                <tr><th>Email:</th><td id="8"></td></tr>
            </table>
        </div>
        <div id="zaizmenu">
            <table>
                <tr><th>Korisničko ime:</th><td><input type="text" name="KorisnickoIme" id="KorisnickoIme" style="margin:5px" /></td></tr>
                <tr><th>Lozinka:</th><td><input type="text" name="Lozinka" id="Lozinka" style="margin:5px" /></td></tr>
                <tr><th>Ime:</th><td><input type="text" name="Ime" id="Ime" style="margin:5px" /></td></tr>
                <tr><th>Prezime:</th><td><input type="text" name="Prezime" id="Prezime" style="margin:5px" /></td></tr>
                <tr><th>JMBG:</th><td><input type="text" name="JMBG" id="JMBG" style="margin:5px" /></td></tr>
                <tr><th>Pol:</th><td><label>Muški:&nbsp&nbsp</label><input type="radio" name="Pol" value="Muski" id="Pol1" /><label>&nbsp&nbspŽenski:&nbsp&nbsp</label><input type="radio" value="Zenski" name="Pol" id="Pol2" /></td></tr>
                <tr><th>Kontakt Telefon:</th><td><input type="text" name="KontaktTelefon" id="KontaktTelefon" style="margin:5px" /></td></tr>
                <tr><th>Email:</th><td><input type="email" name="Email" id="Email" style="margin:5px" /></td></tr>
                <tr><td colspan="2"><hr /></td></tr>
                <tr><td colspan="2" align="right"><b><input type="button" value="Izmeni" id="izmena" /></b></td></tr>
            </table>
        </div>
    </div>
    <div id="dispecer">
        <nav class="nova">
            <div class="container-fluid">
                <div class="collapse navbar-collapse">
                    <div id="d1">
                        Gold TAXI
                    </div>
                    <div class="dropdown">
                        <ul class="nav navbar-nav navbar-right">
                            <li>
                                <button style="background-color:#ffd700;border:none;height:55px;width:auto"><i class="material-icons" style="font-size:xx-large;margin-top:8px">person</i> </button>
                            </li>
                        </ul>
                        <div class="dropdown-content">
                            <a href="#" id="profild">Profil</a>
                            <a href="#" id="izmenid">Izmeni</a>
                            <a href="#" id="odjavid">Odjavi se</a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
        <img src="35240528_10210948662984084_1324220601556008960_n.png" id="soloPicd" />
        <div id="zaprofild">
            <h2>Korisnički profil</h2>
            <hr />
            <table>
                <tr><th>Korisničko ime:</th><td id="1d"></td></tr>
                <tr><th>Lozinka:</th><td id="2d"></td></tr>
                <tr><th>Ime:</th><td id="3d"></td></tr>
                <tr><th>Prezime:</th><td id="4d"></td></tr>
                <tr><th>JMBG:</th><td id="5d"></td></tr>
                <tr><th>Pol:</th><td id="6d"></td></tr>
                <tr><th>Kontakt Telefon:</th><td id="7d"></td></tr>
                <tr><th>Email:</th><td id="8d"></td></tr>
            </table>
        </div>
        <div id="zaizmenud">
            <table>
                <tr><th>Korisničko ime:</th><td><input type="text" name="KorisnickoImed" id="KorisnickoImed" style="margin:5px" /></td></tr>
                <tr><th>Lozinka:</th><td><input type="text" name="Lozinkad" id="Lozinkad" style="margin:5px" /></td></tr>
                <tr><th>Ime:</th><td><input type="text" name="Imed" id="Imed" style="margin:5px" /></td></tr>
                <tr><th>Prezime:</th><td><input type="text" name="Prezimed" id="Prezimed" style="margin:5px" /></td></tr>
                <tr><th>JMBG:</th><td><input type="text" name="JMBGd" id="JMBGd" style="margin:5px" /></td></tr>
                <tr><th>Pol:</th><td><label>Muški:&nbsp&nbsp</label><input type="radio" name="Pold" value="Muski" id="Pol1d" /><label>&nbsp&nbspŽenski:&nbsp&nbsp</label><input type="radio" value="Zenski" name="Pold" id="Pol2d" /></td></tr>
                <tr><th>Kontakt Telefon:</th><td><input type="text" name="KontaktTelefond" id="KontaktTelefond" style="margin:5px" /></td></tr>
                <tr><th>Email:</th><td><input type="email" name="Emaild" id="Emaild" style="margin:5px" /></td></tr>
                <tr><td colspan="2"><hr /></td></tr>
                <tr><td colspan="2" align="right"><b><input type="button" value="Izmeni" id="izmenad" /></b></td></tr>
            </table>
        </div>
    </div>
    <div id="vozac">
        <nav class="nova">
            <div class="container-fluid">
                <div class="collapse navbar-collapse">
                    <div id="d1v">
                        Gold TAXI
                    </div>
                    <div class="dropdown">
                        <ul class="nav navbar-nav navbar-right">
                            <li>
                                <button style="background-color:#ffd700;border:none;height:55px;width:auto"><i class="material-icons" style="font-size:xx-large;margin-top:8px">person</i> </button>
                            </li>
                        </ul>
                        <div class="dropdown-content">
                            <a href="#" id="profil">Profil</a>
                            <a href="#" id="izmeni">Izmeni</a>
                            <a href="#" id="odjavi">Odjavi se</a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </div>
</body>
</html>
